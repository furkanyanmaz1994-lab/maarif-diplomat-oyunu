<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Maarif Diplomat Oyunu (Shuffle)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Naskh+Arabic:wght@400;700&family=Noto+Nastaliq+Urdu:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            background-color: #020617; 
            color: white; 
            user-select: none; 
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Inter', sans-serif;
        }
        
        .font-sans { font-family: 'Inter', sans-serif; }
        .font-arabic { font-family: 'Noto Naskh Arabic', serif; }
        .font-urdu { font-family: 'Noto Nastaliq Urdu', serif; line-height: 2; }

        .game-container { 
            width: 100%;
            max-width: 1024px;
            height: 100%;
            max-height: 600px;
            background: #1e293b; 
            position: relative; 
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        @media (min-width: 768px) {
            .game-container {
                border-radius: 1rem;
                border: 1px solid #334155;
            }
        }
        
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-slide { animation: slideIn 0.4s ease-out forwards; }
        
        .chat-area { overflow-y: auto; scroll-behavior: smooth; }
        .chat-area::-webkit-scrollbar { width: 6px; }
        .chat-area::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        .chat-area::-webkit-scrollbar-track { background: #0f172a; }

        .msg-user { border-bottom-right-radius: 0 !important; margin-left: auto; background: linear-gradient(135deg, #2563eb, #1d4ed8); }
        .msg-bot { border-bottom-left-radius: 0 !important; margin-right: auto; background: #334155; }
        
        [dir="rtl"] .msg-user { border-bottom-left-radius: 0 !important; border-bottom-right-radius: 1rem !important; margin-right: auto; margin-left: 0; }
        [dir="rtl"] .msg-bot { border-bottom-right-radius: 0 !important; border-bottom-left-radius: 1rem !important; margin-left: auto; margin-right: 0; }

        .btn-hover-effect:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3); }
    </style>
</head>
<body class="font-sans">

<div id="app" class="game-container">
    <!-- ƒ∞√ßerik JavaScript ile buraya y√ºklenecek -->
</div>

<script>
    // --- YARDIMCI FONKSƒ∞YON: Dƒ∞Zƒ∞ KARI≈ûTIRMA (Fisher-Yates Shuffle) ---
    function shuffleArray(array) {
        // Dizinin kopyasƒ±nƒ± olu≈ütur (Orijinal veri bozulmasƒ±n diye)
        let shuffled = [...array]; 
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }

    // --- √áOKLU Dƒ∞L VERƒ∞TABANI ---
    const DB = {
        tr: {
            font: 'font-sans', dir: 'ltr',
            headerTitle: "MAARƒ∞F Dƒ∞PLOMAT OYUNU",
            back: "Geri D√∂n",
            selectCat: "Tarafƒ±nƒ± Se√ß",
            countries: "Devletler ve Otoriteler",
            companies: "Kapitalist ≈ûirketler",
            selectScen: "M√ºzakere Konusu",
            turn: "Tur",
            relation: "Barƒ±≈ü ƒ∞bresi",
            win: "Dƒ∞PLOMATƒ∞K ZAFER!",
            winMsg: "Barƒ±≈ü√ßƒ±l ƒ±srarƒ±nƒ±zla g√º√ß odaklarƒ±nƒ± dize getirdiniz. Gelecek sizin!",
            lose: "M√úZAKERE BA≈ûARISIZ",
            loseMsg: "G√º√ß odaklarƒ± sizi ezdi veya sava≈ü √ßƒ±ktƒ±. D√ºnya kaybetti.",
            restart: "Tekrar Oyna",
            scenarios: {
                climate: "ƒ∞klim Krizi", migration: "G√∂√ß Sorunu", economy: "Ekonomik Kriz", war: "Sava≈ü Riski",
                apple: "Veri Gizliliƒüi", amazon: "ƒ∞≈ü√ßi S√∂m√ºr√ºs√º", tesla: "Yapay Zeka Etiƒüi", boston: "Robot Silahlar"
            },
            opponents: {
                climate: "Sanayi Lobisi", migration: "Sƒ±nƒ±r G√ºvenliƒüi", economy: "D√ºnya Bankasƒ±", war: "Sava≈ü Bakanlƒ±ƒüƒ±",
                apple: "Tech Giant CEO", amazon: "Lojistik Devi", tesla: "AI Geli≈ütirici", boston: "Savunma Sanayi"
            },
            questions: [
                { q: "Bizim tek √∂nceliƒüimiz kar ve g√ºvenliktir. Sizin romantik barƒ±≈ü hayalleriniz bize para kazandƒ±rmƒ±yor. Neden sizi dinleyelim?", 
                  a: [
                    { t: "√á√ºnk√º barƒ±≈ü olmadan ticaret yapacak bir d√ºnya kalmayacak.", s: 10 }, 
                    { t: "Haklƒ±sƒ±nƒ±z, paradan √∂nemli bir ≈üey yok.", s: -20 }, 
                    { t: "Sizi yok edeceƒüiz! Bekleyin g√∂r√ºn!", s: -15 }, 
                    { t: "Gelecek nesiller sizi yargƒ±layacak.", s: 5 } 
                  ]
                },
                { q: "B√ºt√ßeyi silahlara ve duvarlara ayƒ±rdƒ±k. ƒ∞nsan haklarƒ± ≈üu an l√ºks. Buna itirazƒ±nƒ±z mƒ± var?",
                  a: [
                    { t: "Silahlar sadece korku √ºretir, eƒüitim ise g√ºven.", s: 10 },
                    { t: "Duvarlarƒ± daha y√ºksek yapmalƒ±yƒ±z.", s: -20 },
                    { t: "O silahlarƒ± size kar≈üƒ± kullanƒ±rƒ±z.", s: -15 },
                    { t: "Kaynaklarƒ± b√∂l√º≈ü√ºrsek duvarlara gerek kalmaz.", s: 15 }
                  ]
                },
                { q: "Halk protesto ediyor ama medyamƒ±z sayesinde onlarƒ± susturuyoruz. Siz ne yapabilirsiniz ki?",
                  a: [
                    { t: "Ger√ßeklerin er ya da ge√ß ortaya √ßƒ±kma huyu vardƒ±r.", s: 10 },
                    { t: "Bize de biraz hisse verirseniz susarƒ±z.", s: -30 },
                    { t: "Sosyal medyadan sizi lin√ß ettireceƒüiz.", s: -5 },
                    { t: "Halkƒ± susturmak yerine onlarƒ± dinleyin.", s: 15 }
                  ]
                },
                { q: "Son uyarƒ±mƒ±z. Ya ≈üartlarƒ±mƒ±zƒ± kabul edersiniz ya da masadan kalkarƒ±z. G√º√ß bizde.",
                  a: [
                    { t: "G√º√ß halktadƒ±r, siz sadece y√∂neticisiniz.", s: 20 },
                    { t: "Tamam, ne derseniz o olsun.", s: -20 },
                    { t: "Defolun gidin!", s: -30 },
                    { t: "Ortak bir zemin bulmak zorundayƒ±z, l√ºtfen.", s: 5 }
                  ]
                }
            ]
        },
        en: {
            font: 'font-sans', dir: 'ltr',
            headerTitle: "MAARIF DIPLOMAT GAME",
            back: "Go Back",
            selectCat: "Select Faction",
            countries: "States & Authorities",
            companies: "Capitalist Corporations",
            selectScen: "Negotiation Topic",
            turn: "Turn",
            relation: "Peace Meter",
            win: "DIPLOMATIC VICTORY!",
            winMsg: "You convinced the powers with peace. The future is yours!",
            lose: "NEGOTIATION FAILED",
            loseMsg: "Power structures crushed you. The world lost.",
            restart: "Play Again",
            scenarios: {
                climate: "Climate Crisis", migration: "Migration Crisis", economy: "Economic Crisis", war: "War Risk",
                apple: "Data Privacy", amazon: "Labor Rights", tesla: "AI Ethics", boston: "Robot Weapons"
            },
            opponents: {
                climate: "Industry Lobby", migration: "Border Control", economy: "World Bank", war: "Ministry of War",
                apple: "Tech Giant CEO", amazon: "Logistics Giant", tesla: "AI Developer", boston: "Defense Corp"
            },
            questions: [
                { q: "Our priority is profit and security. Your romantic peace dreams don't make money. Why listen to you?", 
                  a: [
                    { t: "Without peace, there is no world to trade in.", s: 10 },
                    { t: "You are right, money is everything.", s: -20 },
                    { t: "We will destroy you! Just wait!", s: -15 },
                    { t: "Future generations will judge you.", s: 5 }
                  ]
                },
                { q: "We allocated budget to weapons. Human rights are a luxury. Do you object?",
                  a: [
                    { t: "Weapons breed fear, education breeds trust.", s: 10 },
                    { t: "Build higher walls.", s: -20 },
                    { t: "We will use those weapons against you.", s: -15 },
                    { t: "Share resources, and walls become obsolete.", s: 15 }
                  ]
                },
                { q: "People protest, but we silence them via media. What can you do?",
                  a: [
                    { t: "Truth has a habit of revealing itself.", s: 10 },
                    { t: "Give us shares and we stay silent.", s: -30 },
                    { t: "We will cancel you on social media.", s: -5 },
                    { t: "Listen to the people instead of silencing them.", s: 15 }
                  ]
                },
                { q: "Final warning. Accept our terms or we leave. We have the power.",
                  a: [
                    { t: "Power lies with the people, not you.", s: 20 },
                    { t: "Okay, whatever you say.", s: -20 },
                    { t: "Get out!", s: -30 },
                    { t: "We must find common ground, please.", s: 5 }
                  ]
                }
            ]
        },
        fr: {
            font: 'font-sans', dir: 'ltr',
            headerTitle: "JEU DIPLOMATE MAARIF",
            back: "Retour",
            selectCat: "Choisissez le camp",
            countries: "√âtats et Autorit√©s",
            companies: "Soci√©t√©s Capitalistes",
            selectScen: "Sujet de N√©gociation",
            turn: "Tour",
            relation: "Jauge de Paix",
            win: "VICTOIRE DIPLOMATIQUE!",
            winMsg: "La paix a triomph√© du pouvoir.",
            lose: "√âCHEC DIPLOMATIQUE",
            loseMsg: "Le pouvoir vous a √©cras√©.",
            restart: "Rejouer",
            scenarios: {
                climate: "Crise Climatique", migration: "Migration", economy: "Crise √âconomique", war: "Risque de Guerre",
                apple: "Confidentialit√©", amazon: "Droits des Travailleurs", tesla: "√âthique IA", boston: "Armes Robots"
            },
            opponents: {
                climate: "Lobby Industriel", migration: "Contr√¥le Fronti√®res", economy: "Banque Mondiale", war: "Minist√®re Guerre",
                apple: "PDG Tech", amazon: "G√©ant Logistique", tesla: "D√©veloppeur IA", boston: "D√©fense Corp"
            },
            questions: [
                { q: "Le profit est notre priorit√©. La paix ne rapporte rien. Pourquoi vous √©couter?", 
                  a: [
                    { t: "Sans paix, il n'y a pas de commerce.", s: 10 },
                    { t: "Vous avez raison, l'argent est roi.", s: -20 },
                    { t: "Nous allons vous d√©truire!", s: -15 },
                    { t: "L'histoire vous jugera.", s: 5 }
                  ]
                },
                { q: "Le budget va aux armes. Les droits humains sont un luxe. Une objection?",
                  a: [
                    { t: "Les armes cr√©ent la peur, l'√©ducation la confiance.", s: 10 },
                    { t: "Construisez des murs plus hauts.", s: -20 },
                    { t: "Nous utiliserons ces armes contre vous.", s: -15 },
                    { t: "Partagez les ressources, plus besoin de murs.", s: 15 }
                  ]
                },
                { q: "Les gens protestent, mais nous contr√¥lons les m√©dias. Que ferez-vous?",
                  a: [
                    { t: "La v√©rit√© finit toujours par sortir.", s: 10 },
                    { t: "Payez-nous et nous nous tairons.", s: -30 },
                    { t: "Nous vous attaquerons en ligne.", s: -5 },
                    { t: "√âcoutez le peuple au lieu de le faire taire.", s: 15 }
                  ]
                },
                { q: "Dernier avertissement. Acceptez ou partez. Nous avons le pouvoir.",
                  a: [
                    { t: "Le pouvoir appartient au peuple.", s: 20 },
                    { t: "D'accord, comme vous voulez.", s: -20 },
                    { t: "Sortez d'ici!", s: -30 },
                    { t: "Trouvons un terrain d'entente.", s: 5 }
                  ]
                }
            ]
        },
        ar: {
            font: 'font-arabic', dir: 'rtl',
            headerTitle: "ŸÑÿπÿ®ÿ© ŸÖÿπÿßÿ±ŸÅ ÿßŸÑÿØÿ®ŸÑŸàŸÖÿßÿ≥Ÿäÿ©",
            back: "ÿ±ÿ¨Ÿàÿπ",
            selectCat: "ÿßÿÆÿ™ÿ± ÿßŸÑÿ¨ÿßŸÜÿ®",
            countries: "ÿßŸÑÿØŸàŸÑ ŸàÿßŸÑÿ≥ŸÑÿ∑ÿßÿ™",
            companies: "ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑÿ±ÿ£ÿ≥ŸÖÿßŸÑŸäÿ©",
            selectScen: "ŸÖŸàÿ∂Ÿàÿπ ÿßŸÑÿ™ŸÅÿßŸàÿ∂",
            turn: "ÿ¨ŸàŸÑÿ©",
            relation: "ŸÖŸÇŸäÿßÿ≥ ÿßŸÑÿ≥ŸÑÿßŸÖ",
            win: "ŸÜÿµÿ± ÿØÿ®ŸÑŸàŸÖÿßÿ≥Ÿä!",
            winMsg: "ŸÑŸÇÿØ ÿ£ŸÇŸÜÿπÿ™ ÿßŸÑŸÇŸàŸâ ÿ®ÿßŸÑÿ≥ŸÑÿßŸÖ. ÿßŸÑŸÖÿ≥ÿ™ŸÇÿ®ŸÑ ŸÑŸÉ!",
            lose: "ŸÅÿ¥ŸÑ ÿßŸÑÿ™ŸÅÿßŸàÿ∂",
            loseMsg: "ÿ≥ÿ≠ŸÇÿ™ŸÉ ŸáŸäÿßŸÉŸÑ ÿßŸÑÿ≥ŸÑÿ∑ÿ©. ÿÆÿ≥ÿ± ÿßŸÑÿπÿßŸÑŸÖ.",
            restart: "ŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
            scenarios: {
                climate: "ÿ£ÿ≤ŸÖÿ© ÿßŸÑŸÖŸÜÿßÿÆ", migration: "ÿ£ÿ≤ŸÖÿ© ÿßŸÑŸáÿ¨ÿ±ÿ©", economy: "ÿ£ÿ≤ŸÖÿ© ÿßŸÇÿ™ÿµÿßÿØŸäÿ©", war: "ÿÆÿ∑ÿ± ÿßŸÑÿ≠ÿ±ÿ®",
                apple: "ÿÆÿµŸàÿµŸäÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™", amazon: "ÿ≠ŸÇŸàŸÇ ÿßŸÑÿπŸÖÿßŸÑ", tesla: "ÿ£ÿÆŸÑÿßŸÇŸäÿßÿ™ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä", boston: "ÿ£ÿ≥ŸÑÿ≠ÿ© ÿßŸÑÿ±Ÿàÿ®Ÿàÿ™"
            },
            opponents: {
                climate: "ÿßŸÑŸÑŸàÿ®Ÿä ÿßŸÑÿµŸÜÿßÿπŸä", migration: "ÿ£ŸÖŸÜ ÿßŸÑÿ≠ÿØŸàÿØ", economy: "ÿßŸÑÿ®ŸÜŸÉ ÿßŸÑÿØŸàŸÑŸä", war: "Ÿàÿ≤ÿßÿ±ÿ© ÿßŸÑÿ≠ÿ±ÿ®",
                apple: "ÿßŸÑÿ±ÿ¶Ÿäÿ≥ ÿßŸÑÿ™ŸÜŸÅŸäÿ∞Ÿä ŸÑŸÑÿ™ŸÉŸÜŸàŸÑŸàÿ¨Ÿäÿß", amazon: "ÿπŸÖŸÑÿßŸÇ ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑŸÑŸàÿ¨ÿ≥ÿ™Ÿäÿ©", tesla: "ŸÖÿ∑Ÿàÿ± ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä", boston: "ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿØŸÅÿßÿπ"
            },
            questions: [
                { q: "ÿ£ŸàŸÑŸàŸäÿ™ŸÜÿß ŸáŸä ÿßŸÑÿ±ÿ®ÿ≠ ŸàÿßŸÑÿ£ŸÖŸÜ. ÿ£ÿ≠ŸÑÿßŸÖ ÿßŸÑÿ≥ŸÑÿßŸÖ ŸÑÿß ÿ™ÿ¨ŸÜŸä ÿßŸÑŸÖÿßŸÑ. ŸÑŸÖÿßÿ∞ÿß ŸÜÿ≥ÿ™ŸÖÿπ ÿ•ŸÑŸäŸÉÿü", 
                  a: [
                    { t: "ÿ®ÿØŸàŸÜ ÿ≥ŸÑÿßŸÖÿå ŸÑŸÜ ŸäŸÉŸàŸÜ ŸáŸÜÿßŸÉ ÿπÿßŸÑŸÖ ŸÑŸÑÿ™ÿ¨ÿßÿ±ÿ©.", s: 10 },
                    { t: "ÿ£ŸÜÿ™ ŸÖÿ≠ŸÇÿå ÿßŸÑŸÖÿßŸÑ ŸáŸà ŸÉŸÑ ÿ¥Ÿäÿ°.", s: -20 },
                    { t: "ÿ≥ŸÜÿØŸÖÿ±ŸÉŸÖ! ŸÅŸÇÿ∑ ÿßŸÜÿ™ÿ∏ÿ±Ÿàÿß!", s: -15 },
                    { t: "ÿßŸÑÿ£ÿ¨ŸäÿßŸÑ ÿßŸÑŸÇÿßÿØŸÖÿ© ÿ≥ŸàŸÅ ÿ™ÿ≠ŸÉŸÖ ÿπŸÑŸäŸÉ.", s: 5 }
                  ]
                },
                { q: "ÿÆÿµÿµŸÜÿß ÿßŸÑŸÖŸäÿ≤ÿßŸÜŸäÿ© ŸÑŸÑÿ£ÿ≥ŸÑÿ≠ÿ©. ÿ≠ŸÇŸàŸÇ ÿßŸÑÿ•ŸÜÿ≥ÿßŸÜ ÿ±ŸÅÿßŸáŸäÿ©. ŸáŸÑ ÿ™ÿπÿ™ÿ±ÿ∂ÿü",
                  a: [
                    { t: "ÿßŸÑÿ£ÿ≥ŸÑÿ≠ÿ© ÿ™ŸàŸÑÿØ ÿßŸÑÿÆŸàŸÅÿå ŸàÿßŸÑÿ™ÿπŸÑŸäŸÖ ŸäŸàŸÑÿØ ÿßŸÑÿ´ŸÇÿ©.", s: 10 },
                    { t: "ÿßÿ®ŸÜŸàÿß ÿ¨ÿØÿ±ÿßŸÜŸãÿß ÿ£ÿπŸÑŸâ.", s: -20 },
                    { t: "ÿ≥ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿ™ŸÑŸÉ ÿßŸÑÿ£ÿ≥ŸÑÿ≠ÿ© ÿ∂ÿØŸÉŸÖ.", s: -15 },
                    { t: "ÿ¥ÿßÿ±ŸÉŸàÿß ÿßŸÑŸÖŸàÿßÿ±ÿØÿå Ÿàÿ≥ÿ™ÿµÿ®ÿ≠ ÿßŸÑÿ¨ÿØÿ±ÿßŸÜ ÿ®ŸÑÿß ÿ¨ÿØŸàŸâ.", s: 15 }
                  ]
                },
                { q: "ÿßŸÑŸÜÿßÿ≥ Ÿäÿ≠ÿ™ÿ¨ŸàŸÜÿå ŸÑŸÉŸÜŸÜÿß ŸÜÿ≥ŸÉÿ™ŸáŸÖ ÿπÿ®ÿ± ÿßŸÑÿ•ÿπŸÑÿßŸÖ. ŸÖÿßÿ∞ÿß ŸäŸÖŸÉŸÜŸÉ ÿ£ŸÜ ÿ™ŸÅÿπŸÑÿü",
                  a: [
                    { t: "ÿßŸÑÿ≠ŸÇŸäŸÇÿ© ÿ≥ÿ™ÿ∏Ÿáÿ± ÿπÿßÿ¨ŸÑÿßŸã ÿ£ŸÖ ÿ¢ÿ¨ŸÑÿßŸã.", s: 10 },
                    { t: "ÿßÿØŸÅÿπŸàÿß ŸÑŸÜÿß Ÿàÿ≥ŸÜŸÑÿ™ÿ≤ŸÖ ÿßŸÑÿµŸÖÿ™.", s: -30 },
                    { t: "ÿ≥ŸÜŸáÿßÿ¨ŸÖŸÉŸÖ ÿπŸÑŸâ Ÿàÿ≥ÿßÿ¶ŸÑ ÿßŸÑÿ™ŸàÿßÿµŸÑ.", s: -5 },
                    { t: "ÿßÿ≥ÿ™ŸÖÿπŸàÿß ŸÑŸÑŸÜÿßÿ≥ ÿ®ÿØŸÑ ÿ•ÿ≥ŸÉÿßÿ™ŸáŸÖ.", s: 15 }
                  ]
                },
                { q: "ÿ™ÿ≠ÿ∞Ÿäÿ± ÿ£ÿÆŸäÿ±. ÿßŸÇÿ®ŸÑŸàÿß ÿ¥ÿ±Ÿàÿ∑ŸÜÿß ÿ£Ÿà ŸÜÿ∫ÿßÿØÿ±. ÿßŸÑŸÇŸàÿ© ŸÖÿπŸÜÿß.",
                  a: [
                    { t: "ÿßŸÑŸÇŸàÿ© ÿ®ŸäÿØ ÿßŸÑÿ¥ÿπÿ®ÿå ŸàŸÑŸäÿ≥ ÿ®ŸäÿØŸÉŸÖ.", s: 20 },
                    { t: "ÿ≠ÿ≥ŸÜŸãÿßÿå ŸÉŸÖÿß ÿ™ÿ±ŸäÿØŸàŸÜ.", s: -20 },
                    { t: "ÿßÿÆÿ±ÿ¨Ÿàÿß ŸÖŸÜ ŸáŸÜÿß!", s: -30 },
                    { t: "Ÿäÿ¨ÿ® ÿ£ŸÜ ŸÜÿ¨ÿØ ÿ£ÿ±ÿ∂Ÿäÿ© ŸÖÿ¥ÿ™ÿ±ŸÉÿ©.", s: 5 }
                  ]
                }
            ]
        },
        es: {
            font: 'font-sans', dir: 'ltr',
            headerTitle: "JUEGO DIPLOM√ÅTICO MAARIF",
            back: "Atr√°s",
            selectCat: "Selecciona Facci√≥n",
            countries: "Estados y Autoridades",
            companies: "Corporaciones Capitalistas",
            selectScen: "Tema de Negociaci√≥n",
            turn: "Turno",
            relation: "Medidor de Paz",
            win: "¬°VICTORIA DIPLOM√ÅTICA!",
            winMsg: "Triunfaste con la paz.",
            lose: "FRACASO DIPLOM√ÅTICO",
            loseMsg: "El poder te aplast√≥.",
            restart: "Jugar de Nuevo",
            scenarios: {
                climate: "Crisis Clim√°tica", migration: "Migraci√≥n", economy: "Crisis Econ√≥mica", war: "Riesgo de Guerra",
                apple: "Privacidad", amazon: "Derechos Laborales", tesla: "√âtica IA", boston: "Armas Robot"
            },
            opponents: {
                climate: "Lobby Industrial", migration: "Control Fronterizo", economy: "Banco Mundial", war: "Ministerio de Guerra",
                apple: "CEO Tecnol√≥gico", amazon: "Gigante Log√≠stico", tesla: "Desarrollador IA", boston: "Corp. Defensa"
            },
            questions: [
                { q: "Nuestra prioridad es el lucro. La paz no da dinero. ¬øPor qu√© escucharte?", 
                  a: [
                    { t: "Sin paz, no hay comercio.", s: 10 },
                    { t: "Tienes raz√≥n, el dinero manda.", s: -20 },
                    { t: "¬°Los destruiremos!", s: -15 },
                    { t: "La historia los juzgar√°.", s: 5 }
                  ]
                },
                { q: "El presupuesto es para armas. Los DDHH son un lujo. ¬øTe opones?",
                  a: [
                    { t: "Las armas crean miedo, la educaci√≥n confianza.", s: 10 },
                    { t: "Construyan muros m√°s altos.", s: -20 },
                    { t: "Usaremos esas armas en su contra.", s: -15 },
                    { t: "Compartan recursos y no habr√° muros.", s: 15 }
                  ]
                },
                { q: "La gente protesta, pero controlamos los medios. ¬øQu√© har√°n?",
                  a: [
                    { t: "La verdad siempre sale a la luz.", s: 10 },
                    { t: "P√°gannos y callaremos.", s: -30 },
                    { t: "Los atacaremos en redes sociales.", s: -5 },
                    { t: "Escuchen al pueblo en lugar de callarlo.", s: 15 }
                  ]
                },
                { q: "√öltima advertencia. Acepten o nos vamos. Tenemos el poder.",
                  a: [
                    { t: "El poder reside en el pueblo.", s: 20 },
                    { t: "Est√° bien, lo que digan.", s: -20 },
                    { t: "¬°L√°rguense!", s: -30 },
                    { t: "Debemos encontrar un acuerdo.", s: 5 }
                  ]
                }
            ]
        },
        ru: {
            font: 'font-sans', dir: 'ltr',
            headerTitle: "–î–ò–ü–õ–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ò–ì–†–ê MAARIF",
            back: "–ù–∞–∑–∞–¥",
            selectCat: "–í—ã–±–µ—Ä–∏—Ç–µ –°—Ç–æ—Ä–æ–Ω—É",
            countries: "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–∞ –∏ –í–ª–∞—Å—Ç–∏",
            companies: "–ö–∞–ø–∏—Ç–∞–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ö–æ—Ä–ø–æ—Ä–∞—Ü–∏–∏",
            selectScen: "–¢–µ–º–∞ –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤",
            turn: "–•–æ–¥",
            relation: "–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ú–∏—Ä–∞",
            win: "–î–ò–ü–õ–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ü–û–ë–ï–î–ê!",
            winMsg: "–ú–∏—Ä –ø–æ–±–µ–¥–∏–ª —Å–∏–ª—É.",
            lose: "–ü–†–û–í–ê–õ",
            loseMsg: "–í–ª–∞—Å—Ç—å —Ä–∞–∑–¥–∞–≤–∏–ª–∞ –≤–∞—Å.",
            restart: "–ò–≥—Ä–∞—Ç—å –°–Ω–æ–≤–∞",
            scenarios: {
                climate: "–ö–ª–∏–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ö—Ä–∏–∑–∏—Å", migration: "–ú–∏–≥—Ä–∞—Ü–∏—è", economy: "–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –ö—Ä–∏–∑–∏—Å", war: "–†–∏—Å–∫ –í–æ–π–Ω—ã",
                apple: "–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å", amazon: "–¢—Ä—É–¥–æ–≤—ã–µ –ü—Ä–∞–≤–∞", tesla: "–≠—Ç–∏–∫–∞ –ò–ò", boston: "–†–æ–±–æ—Ç—ã-–û—Ä—É–∂–∏–µ"
            },
            opponents: {
                climate: "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ –õ–æ–±–±–∏", migration: "–ü–æ–≥—Ä–∞–Ω–∫–æ–Ω—Ç—Ä–æ–ª—å", economy: "–í—Å–µ–º–∏—Ä–Ω—ã–π –ë–∞–Ω–∫", war: "–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –í–æ–π–Ω—ã",
                apple: "CEO –¢–µ—Ö–Ω–æ–≥–∏–≥–∞–Ω—Ç–∞", amazon: "–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –ì–∏–≥–∞–Ω—Ç", tesla: "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ò–ò", boston: "–û–±–æ—Ä–æ–Ω–Ω–∞—è –ö–æ—Ä–ø."
            },
            questions: [
                { q: "–ù–∞—à–∞ —Ü–µ–ª—å - –ø—Ä–∏–±—ã–ª—å. –ú–∏—Ä –Ω–µ –ø—Ä–∏–Ω–æ—Å–∏—Ç –¥–µ–Ω–µ–≥. –ó–∞—á–µ–º –Ω–∞–º —Å–ª—É—à–∞—Ç—å –≤–∞—Å?", 
                  a: [
                    { t: "–ë–µ–∑ –º–∏—Ä–∞ –Ω–µ –±—É–¥–µ—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏.", s: 10 },
                    { t: "–í—ã –ø—Ä–∞–≤—ã, –¥–µ–Ω—å–≥–∏ —ç—Ç–æ –≤—Å—ë.", s: -20 },
                    { t: "–ú—ã —É–Ω–∏—á—Ç–æ–∂–∏–º –≤–∞—Å!", s: -15 },
                    { t: "–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—Å—É–¥–∏—Ç –Ω–∞—Å.", s: 5 }
                  ]
                },
                { q: "–ë—é–¥–∂–µ—Ç –∏–¥–µ—Ç –Ω–∞ –æ—Ä—É–∂–∏–µ. –ü—Ä–∞–≤–∞ —á–µ–ª–æ–≤–µ–∫–∞ - —Ä–æ—Å–∫–æ—à—å. –í–æ–∑—Ä–∞–∂–∞–µ—Ç–µ?",
                  a: [
                    { t: "–û—Ä—É–∂–∏–µ —Ä–æ–∂–¥–∞–µ—Ç —Å—Ç—Ä–∞—Ö, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ - –¥–æ–≤–µ—Ä–∏–µ.", s: 10 },
                    { t: "–°—Ç—Ä–æ–π—Ç–µ —Å—Ç–µ–Ω—ã –≤—ã—à–µ.", s: -20 },
                    { t: "–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ –æ—Ä—É–∂–∏–µ –ø—Ä–æ—Ç–∏–≤ –≤–∞—Å.", s: -15 },
                    { t: "–î–µ–ª–∏—Ç–µ—Å—å —Ä–µ—Å—É—Ä—Å–∞–º–∏, –∏ —Å—Ç–µ–Ω—ã –Ω–µ –Ω—É–∂–Ω—ã.", s: 15 }
                  ]
                },
                { q: "–õ—é–¥–∏ –ø—Ä–æ—Ç–µ—Å—Ç—É—é—Ç, –Ω–æ –°–ú–ò –Ω–∞—à–∏. –ß—Ç–æ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ?",
                  a: [
                    { t: "–ü—Ä–∞–≤–¥–∞ –≤—Å–µ–≥–¥–∞ –≤—ã—Ö–æ–¥–∏—Ç –Ω–∞—Ä—É–∂—É.", s: 10 },
                    { t: "–ó–∞–ø–ª–∞—Ç–∏—Ç–µ –Ω–∞–º, –∏ –º—ã –∑–∞–º–æ–ª—á–∏–º.", s: -30 },
                    { t: "–ú—ã –∞—Ç–∞–∫—É–µ–º –≤–∞—Å –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö.", s: -5 },
                    { t: "–°–ª—É—à–∞–π—Ç–µ –ª—é–¥–µ–π, –∞ –Ω–µ –∑–∞—Ç—ã–∫–∞–π—Ç–µ –∏—Ö.", s: 15 }
                  ]
                },
                { q: "–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ. –ü—Ä–∏–º–∏—Ç–µ —É—Å–ª–æ–≤–∏—è –∏–ª–∏ –º—ã —É—Ö–æ–¥–∏–º.",
                  a: [
                    { t: "–í–ª–∞—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –Ω–∞—Ä–æ–¥—É.", s: 20 },
                    { t: "–•–æ—Ä–æ—à–æ, –∫–∞–∫ —Å–∫–∞–∂–µ—Ç–µ.", s: -20 },
                    { t: "–£–±–∏—Ä–∞–π—Ç–µ—Å—å!", s: -30 },
                    { t: "–ú—ã –¥–æ–ª–∂–Ω—ã –Ω–∞–π—Ç–∏ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å.", s: 5 }
                  ]
                }
            ]
        },
        ur: {
            font: 'font-urdu', dir: 'rtl',
            headerTitle: "ŸÖÿπÿßÿ±ŸÅ ⁄àŸæŸÑŸàŸÖ€åŸπ ⁄Ø€åŸÖ",
            back: "ŸàÿßŸæÿ≥",
            selectCat: "ŸÅÿ±€åŸÇ ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±€å⁄∫",
            countries: "ÿ±€åÿßÿ≥ÿ™€å⁄∫ ÿßŸàÿ± ÿ≠⁄©ÿßŸÖ",
            companies: "ÿ≥ÿ±ŸÖÿß€å€Å ÿØÿßÿ± ⁄©ŸÖŸæŸÜ€åÿß⁄∫",
            selectScen: "ŸÖÿ∞ÿß⁄©ÿ±ÿßÿ™ ⁄©ÿß ŸÖŸàÿ∂Ÿàÿπ",
            turn: "ÿ®ÿßÿ±€å",
            relation: "ÿßŸÖŸÜ ⁄©ÿß ŸÖ€åŸπÿ±",
            win: "ÿ≥ŸÅÿßÿ±ÿ™€å ŸÅÿ™ÿ≠!",
            winMsg: "ÿ¢Ÿæ ŸÜ€í ÿ∑ÿßŸÇÿ™ ⁄©Ÿà ÿßŸÖŸÜ ÿ≥€í ŸÇÿßÿ¶ŸÑ ⁄©€åÿß€î ŸÖÿ≥ÿ™ŸÇÿ®ŸÑ ÿ¢Ÿæ ⁄©ÿß €Å€í!",
            lose: "ŸÖÿ∞ÿß⁄©ÿ±ÿßÿ™ ŸÜÿß⁄©ÿßŸÖ",
            loseMsg: "ÿ∑ÿßŸÇÿ™ ⁄©€í ⁄à⁄æÿßŸÜ⁄ÜŸà⁄∫ ŸÜ€í ÿ¢Ÿæ ⁄©Ÿà ⁄©⁄ÜŸÑ ÿØ€åÿß€î ÿØŸÜ€åÿß €Åÿßÿ± ⁄Øÿ¶€å€î",
            restart: "ÿØŸàÿ®ÿßÿ±€Å ⁄©⁄æ€åŸÑ€å⁄∫",
            scenarios: {
                climate: "ŸÖÿßÿ≠ŸàŸÑ€åÿßÿ™€å ÿ®ÿ≠ÿ±ÿßŸÜ", migration: "€Åÿ¨ÿ±ÿ™ ⁄©ÿß ŸÖÿ≥ÿ¶ŸÑ€Å", economy: "ŸÖÿπÿßÿ¥€å ÿ®ÿ≠ÿ±ÿßŸÜ", war: "ÿ¨ŸÜ⁄Ø ⁄©ÿß ÿÆÿ∑ÿ±€Å",
                apple: "⁄à€åŸπÿß ⁄©€å ÿ±ÿßÿ≤ÿØÿßÿ±€å", amazon: "ŸÖÿ≤ÿØŸàÿ±Ÿà⁄∫ ⁄©€í ÿ≠ŸÇŸàŸÇ", tesla: "ŸÖÿµŸÜŸàÿπ€å ÿ∞€ÅÿßŸÜÿ™ ⁄©€í ÿßÿÆŸÑÿßŸÇ€åÿßÿ™", boston: "ÿ±Ÿàÿ®ŸàŸπ €Åÿ™⁄æ€åÿßÿ±"
            },
            opponents: {
                climate: "ÿµŸÜÿπÿ™€å ŸÑÿßÿ®€å", migration: "ÿ≥ÿ±ÿ≠ÿØ€å ⁄©ŸÜŸπÿ±ŸàŸÑ", economy: "Ÿàÿ±ŸÑ⁄à ÿ®€åŸÜ⁄©", war: "Ÿàÿ≤ÿßÿ±ÿ™ ÿ¨ŸÜ⁄Ø",
                apple: "Ÿπ€å⁄© ⁄©ŸÖŸæŸÜ€å ÿ≥€å ÿß€å ÿßŸà", amazon: "ŸÑÿßÿ¨ÿ≥Ÿπ⁄© ⁄©ŸÖŸæŸÜ€å", tesla: "AI ⁄àŸà€åŸÑŸæÿ±", boston: "ÿØŸÅÿßÿπ€å ⁄©ÿßÿ±ŸæŸàÿ±€åÿ¥ŸÜ"
            },
            questions: [
                { q: "€ÅŸÖÿßÿ±€å ÿ™ÿ±ÿ¨€åÿ≠ ŸÖŸÜÿßŸÅÿπ €Å€í€î ÿßŸÖŸÜ ÿ≥€í Ÿæ€åÿ≥€Å ŸÜ€Å€å⁄∫ ÿ®ŸÜÿ™ÿß€î €ÅŸÖ ÿ¢Ÿæ ⁄©Ÿà ⁄©€åŸà⁄∫ ÿ≥ŸÜ€å⁄∫ÿü", 
                  a: [
                    { t: "ÿßŸÖŸÜ ⁄©€í ÿ®ÿ∫€åÿ± ÿ™ÿ¨ÿßÿ±ÿ™ ⁄©€í ŸÑ€å€í ⁄©Ÿàÿ¶€å ÿØŸÜ€åÿß ŸÜ€Å€å⁄∫ ÿ®⁄Ü€í ⁄Ø€å€î", s: 10 },
                    { t: "ÿ¢Ÿæ ÿµÿ≠€åÿ≠ ⁄©€Å€Å ÿ±€Å€í €Å€å⁄∫ÿå Ÿæ€åÿ≥€Å €Å€å ÿ≥ÿ® ⁄©⁄Ü⁄æ €Å€í€î", s: -20 },
                    { t: "€ÅŸÖ ÿ¢Ÿæ ⁄©Ÿà ÿ™ÿ®ÿß€Å ⁄©ÿ± ÿØ€å⁄∫ ⁄Ø€í!", s: -15 },
                    { t: "ÿ¢ŸÜ€í ŸàÿßŸÑ€å ŸÜÿ≥ŸÑ€å⁄∫ ÿ¢Ÿæ ⁄©ÿß ŸÅ€åÿµŸÑ€Å ⁄©ÿ±€å⁄∫ ⁄Ø€å€î", s: 5 }
                  ]
                },
                { q: "€ÅŸÖ ŸÜ€í ÿ®ÿ¨Ÿπ €Åÿ™⁄æ€åÿßÿ±Ÿà⁄∫ ⁄©€í ŸÑ€å€í ŸÖÿÆÿ™ÿµ ⁄©€åÿß€î ÿßŸÜÿ≥ÿßŸÜ€å ÿ≠ŸÇŸàŸÇ ÿß€å⁄© ÿ™ÿπ€åÿ¥ €Å€å⁄∫€î ⁄©€åÿß ÿ¢Ÿæ ⁄©Ÿà ÿßÿπÿ™ÿ±ÿßÿ∂ €Å€íÿü",
                  a: [
                    { t: "€Åÿ™⁄æ€åÿßÿ± ÿÆŸàŸÅ Ÿæ€åÿØÿß ⁄©ÿ±ÿ™€í €Å€å⁄∫ÿå ÿ™ÿπŸÑ€åŸÖ ÿßÿπÿ™ŸÖÿßÿØ Ÿæ€åÿØÿß ⁄©ÿ±ÿ™€å €Å€í€î", s: 10 },
                    { t: "ÿØ€åŸàÿßÿ±€å⁄∫ ŸÖÿ≤€åÿØ ÿßŸàŸÜ⁄Ü€å ÿ®ŸÜÿßÿ¶€å⁄∫€î", s: -20 },
                    { t: "€ÅŸÖ Ÿà€Å €Åÿ™⁄æ€åÿßÿ± ÿ¢Ÿæ ⁄©€í ÿÆŸÑÿßŸÅ ÿßÿ≥ÿ™ÿπŸÖÿßŸÑ ⁄©ÿ±€å⁄∫ ⁄Ø€í€î", s: -15 },
                    { t: "Ÿàÿ≥ÿßÿ¶ŸÑ ÿ®ÿßŸÜŸπ€å⁄∫ÿå ÿØ€åŸàÿßÿ±Ÿà⁄∫ ⁄©€å ÿ∂ÿ±Ÿàÿ±ÿ™ ŸÜ€Å€å⁄∫ ÿ±€Å€í ⁄Ø€å€î", s: 15 }
                  ]
                },
                { q: "ŸÑŸà⁄Ø ÿßÿ≠ÿ™ÿ¨ÿßÿ¨ ⁄©ÿ± ÿ±€Å€í €Å€å⁄∫ÿå ŸÑ€å⁄©ŸÜ ŸÖ€å⁄à€åÿß €ÅŸÖÿßÿ±€í ⁄©ŸÜŸπÿ±ŸàŸÑ ŸÖ€å⁄∫ €Å€í€î ÿ¢Ÿæ ⁄©€åÿß ⁄©ÿ± ÿ≥⁄©ÿ™€í €Å€å⁄∫ÿü",
                  a: [
                    { t: "ÿ≥⁄Üÿßÿ¶€å €ÅŸÖ€åÿ¥€Å ÿ≥ÿßŸÖŸÜ€í ÿ¢ €Å€å ÿ¨ÿßÿ™€å €Å€í€î", s: 10 },
                    { t: "€ÅŸÖ€å⁄∫ Ÿæ€åÿ≥€í ÿØ€å⁄∫ ÿßŸàÿ± €ÅŸÖ ÿÆÿßŸÖŸàÿ¥ ÿ±€Å€å⁄∫ ⁄Ø€í€î", s: -30 },
                    { t: "€ÅŸÖ ÿ≥Ÿàÿ¥ŸÑ ŸÖ€å⁄à€åÿß Ÿæÿ± ÿ¢Ÿæ Ÿæÿ± ÿ≠ŸÖŸÑ€Å ⁄©ÿ±€å⁄∫ ⁄Ø€í€î", s: -5 },
                    { t: "ŸÑŸà⁄ØŸà⁄∫ ⁄©Ÿà ÿÆÿßŸÖŸàÿ¥ ⁄©ÿ±ŸÜ€í ⁄©€í ÿ®ÿ¨ÿßÿ¶€í ÿßŸÜ ⁄©€å ÿ®ÿßÿ™ ÿ≥ŸÜ€å⁄∫€î", s: 15 }
                  ]
                },
                { q: "ÿ¢ÿÆÿ±€å ÿßŸÜÿ™ÿ®ÿß€Å€î €ÅŸÖÿßÿ±€å ÿ¥ÿ±ÿßÿ¶ÿ∑ ŸÖÿßŸÜ ŸÑ€å⁄∫ Ÿàÿ±ŸÜ€Å €ÅŸÖ ÿ¨ÿß ÿ±€Å€í €Å€å⁄∫€î ÿ∑ÿßŸÇÿ™ €ÅŸÖÿßÿ±€í Ÿæÿßÿ≥ €Å€í€î",
                  a: [
                    { t: "ÿ∑ÿßŸÇÿ™ ÿπŸàÿßŸÖ ⁄©€í Ÿæÿßÿ≥ €Å€íÿå ÿ¢Ÿæ ⁄©€í Ÿæÿßÿ≥ ŸÜ€Å€å⁄∫€î", s: 20 },
                    { t: "Ÿπ⁄æ€å⁄© €Å€íÿå ÿ¨Ÿà ÿ¢Ÿæ ⁄©€Å€å⁄∫€î", s: -20 },
                    { t: "ŸÜ⁄©ŸÑ ÿ¨ÿßÿ§ €å€Åÿß⁄∫ ÿ≥€í!", s: -30 },
                    { t: "€ÅŸÖ€å⁄∫ ⁄©Ÿàÿ¶€å ÿØÿ±ŸÖ€åÿßŸÜ€å ÿ±ÿßÿ≥ÿ™€Å ŸÜ⁄©ÿßŸÑŸÜÿß €ÅŸà⁄Øÿß€î", s: 5 }
                  ]
                }
            ]
        }
    };

    // --- OYUN STATE ---
    let state = {
        lang: 'tr',
        phase: 'lang', // lang -> category -> scenario -> game -> result
        category: null,
        scenarioKey: null,
        score: 50,
        turn: 1,
        maxTurns: 20,
        history: []
    };

    const app = document.getElementById('app');

    // --- NAVIGATION LOGIC ---
    function goBack() {
        if(state.phase === 'result') { state.phase = 'lang'; }
        else if(state.phase === 'game') { state.phase = 'scenario'; }
        else if(state.phase === 'scenario') { state.phase = 'category'; }
        else if(state.phase === 'category') { state.phase = 'lang'; }
        render();
    }

    // --- RENDERERS ---

    function render() {
        app.innerHTML = '';
        const langData = DB[state.lang] || DB['tr'];
        
        document.body.className = langData.font;
        document.body.dir = langData.dir;

        const header = document.createElement('div');
        header.className = "bg-slate-900/90 backdrop-blur-sm p-4 border-b border-slate-700 flex items-center justify-between sticky top-0 z-50 shadow-lg shrink-0";
        
        const titleDiv = document.createElement('div');
        titleDiv.className = "text-center w-full font-bold text-blue-400 tracking-wider text-lg md:text-xl";
        titleDiv.innerHTML = langData.headerTitle;

        if (state.phase !== 'lang') {
            const backBtn = document.createElement('button');
            backBtn.onclick = goBack;
            backBtn.className = "absolute left-6 bg-slate-800 hover:bg-slate-700 px-4 py-2 rounded-lg text-sm border border-slate-600 transition-colors flex items-center gap-2";
            backBtn.innerText = langData.dir === 'rtl' ? '‚ûú' : '‚¨Ö ' + langData.back;
            if(langData.dir === 'rtl') backBtn.className += " right-6 left-auto"; 
            header.appendChild(backBtn);
        }
        
        header.appendChild(titleDiv);
        app.appendChild(header);

        const content = document.createElement('div');
        content.className = "flex-1 overflow-hidden flex flex-col w-full";
        
        if (state.phase === 'lang') renderLang(content);
        else if (state.phase === 'category') renderCategory(content, langData);
        else if (state.phase === 'scenario') renderScenario(content, langData);
        else if (state.phase === 'game') renderGame(content, langData);
        else if (state.phase === 'result') renderResult(content, langData);

        app.appendChild(content);
    }

    function renderLang(container) {
        const langs = [
            { code: 'tr', name: 'T√ºrk√ße', flag: 'üáπüá∑' },
            { code: 'en', name: 'English', flag: 'üá¨üáß' },
            { code: 'fr', name: 'Fran√ßais', flag: 'üá´üá∑' },
            { code: 'es', name: 'Espa√±ol', flag: 'üá™üá∏' },
            { code: 'ru', name: '–†—É—Å—Å–∫–∏–π', flag: 'üá∑üá∫' },
            { code: 'ar', name: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©', flag: 'üá∏üá¶' },
            { code: 'ur', name: 'ÿßÿ±ÿØŸà', flag: 'üáµüá∞' },
        ];
        
        container.innerHTML = `
            <div class="flex flex-col items-center justify-center h-full p-8 animate-slide">
                <div class="text-6xl mb-8 drop-shadow-[0_0_15px_rgba(59,130,246,0.5)]">üåç</div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 w-full max-w-4xl">
                    ${langs.map(l => `
                        <button onclick="setLang('${l.code}')" class="bg-slate-800 hover:bg-slate-700 p-6 rounded-2xl flex flex-col items-center border border-slate-600 transition-all btn-hover-effect">
                            <span class="text-4xl mb-3">${l.flag}</span>
                            <span class="text-lg font-semibold">${l.name}</span>
                        </button>
                    `).join('')}
                </div>
            </div>
        `;
    }

    function renderCategory(container, t) {
        container.innerHTML = `
            <div class="flex flex-row items-center justify-center h-full p-10 animate-slide gap-10">
                <button onclick="setCategory('countries')" class="group relative w-full max-w-md h-64 bg-gradient-to-br from-red-900/80 to-slate-900 p-8 rounded-3xl border border-red-800/50 hover:border-red-500 transition-all text-left flex flex-col justify-end btn-hover-effect overflow-hidden">
                    <div class="absolute top-4 right-6 text-8xl opacity-10 group-hover:opacity-20 transition-opacity">üèõÔ∏è</div>
                    <div class="relative z-10">
                        <h3 class="text-3xl font-bold text-red-400 mb-2 group-hover:text-red-300">${t.countries}</h3>
                        <div class="w-full h-1.5 bg-red-900 rounded mt-2"></div>
                    </div>
                </button>

                <button onclick="setCategory('companies')" class="group relative w-full max-w-md h-64 bg-gradient-to-br from-green-900/80 to-slate-900 p-8 rounded-3xl border border-green-800/50 hover:border-green-500 transition-all text-left flex flex-col justify-end btn-hover-effect overflow-hidden">
                    <div class="absolute top-4 right-6 text-8xl opacity-10 group-hover:opacity-20 transition-opacity">üè≠</div>
                    <div class="relative z-10">
                        <h3 class="text-3xl font-bold text-green-400 mb-2 group-hover:text-green-300">${t.companies}</h3>
                        <div class="w-full h-1.5 bg-green-900 rounded mt-2"></div>
                    </div>
                </button>
            </div>
        `;
    }

    function renderScenario(container, t) {
        const keys = state.category === 'countries' 
            ? ['climate', 'migration', 'economy', 'war'] 
            : ['apple', 'amazon', 'tesla', 'boston'];
            
        container.innerHTML = `
            <div class="flex flex-col h-full p-8 animate-slide items-center justify-center">
                <h2 class="text-center text-3xl font-bold text-slate-300 mb-10">${t.selectScen}</h2>
                <div class="grid grid-cols-2 gap-6 w-full max-w-4xl">
                    ${keys.map(k => `
                        <button onclick="startGame('${k}')" class="bg-slate-800 p-8 rounded-2xl border border-slate-700 flex items-center justify-between hover:bg-slate-700 hover:border-blue-500 transition-all btn-hover-effect">
                            <span class="font-bold text-xl">${t.scenarios[k]}</span>
                            <span class="text-slate-500 text-2xl">‚ûú</span>
                        </button>
                    `).join('')}
                </div>
            </div>
        `;
    }

    function renderGame(container, t) {
        const scenarioName = t.scenarios[state.scenarioKey];
        const opponentName = t.opponents[state.scenarioKey];
        
        const qIndex = (state.turn - 1) % 4;
        const currentData = t.questions[qIndex];
        
        // --- CEVAPLARI KARI≈ûTIRMA (SHUFFLE) ---
        // Her render i≈üleminde cevaplarƒ± karƒ±≈ütƒ±rƒ±yoruz ki butonlarƒ±n yeri deƒüi≈üsin.
        const shuffledAnswers = shuffleArray(currentData.a);

        let barColor = state.score > 60 ? 'bg-green-500' : (state.score < 30 ? 'bg-red-500' : 'bg-yellow-500');

        container.innerHTML = `
            <div class="flex flex-col h-full">
                <div class="bg-slate-800/80 px-8 py-3 shadow border-b border-slate-700 shrink-0">
                    <div class="flex justify-between items-center text-sm text-slate-300 mb-2">
                        <span class="font-bold text-lg text-red-400">VS: ${opponentName}</span>
                        <span class="font-mono bg-slate-900 px-3 py-1 rounded border border-slate-700">${t.turn}: ${state.turn}/${state.maxTurns}</span>
                    </div>
                    <div class="flex items-center gap-4">
                         <span class="text-xs text-slate-500 w-24 text-right">${t.relation}</span>
                         <div class="flex-1 h-3 bg-slate-900 rounded-full overflow-hidden border border-slate-600">
                            <div class="h-full ${barColor} transition-all duration-700 ease-out" style="width: ${state.score}%"></div>
                        </div>
                        <span class="text-xs font-mono text-white w-8">${state.score}%</span>
                    </div>
                </div>

                <div class="flex-1 flex overflow-hidden">
                    <div id="chat-feed" class="flex-1 chat-area p-6 space-y-6 bg-slate-900/50">
                        ${state.history.map(msg => `
                            <div class="flex w-full ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}">
                                <div class="p-4 max-w-[70%] text-base shadow-lg ${msg.sender === 'user' ? 'text-white msg-user' : 'text-slate-200 msg-bot'}">
                                    ${msg.text}
                                </div>
                            </div>
                        `).join('')}
                        
                        <div class="flex w-full justify-start animate-slide">
                            <div class="bg-slate-800 text-white p-5 max-w-[75%] text-base shadow-xl border-l-4 border-red-500 msg-bot">
                                <div class="text-xs text-red-400 font-bold mb-2 uppercase tracking-wider flex items-center gap-2">
                                    <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                                    ${opponentName}
                                </div>
                                ${currentData.q}
                            </div>
                        </div>
                    </div>

                    <div class="bg-slate-800 p-6 border-l border-slate-700 w-1/3 min-w-[300px] flex flex-col justify-center shadow-2xl z-20">
                        <div class="grid grid-cols-1 gap-4 h-full overflow-y-auto">
                            <!-- Karƒ±≈ütƒ±rƒ±lmƒ±≈ü cevaplarƒ± ekrana basƒ±yoruz -->
                            ${shuffledAnswers.map(opt => `
                                <button onclick="handleTurn('${opt.t.replace(/'/g, "\\'")}', ${opt.s}, '${currentData.q.replace(/'/g, "\\'")}')" 
                                        class="text-left p-4 rounded-xl bg-slate-700 hover:bg-blue-600 border border-slate-600 hover:border-blue-400 text-sm md:text-base active:scale-95 transition-all shadow-md flex items-center h-full">
                                    ${opt.t}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            </div>
        `;

        setTimeout(() => {
            const chat = document.getElementById('chat-feed');
            if(chat) chat.scrollTop = chat.scrollHeight;
        }, 50);
    }

    function renderResult(container, t) {
        const won = state.score >= 50;
        const color = won ? 'text-green-400' : 'text-red-500';
        
        container.innerHTML = `
            <div class="flex flex-col items-center justify-center h-full p-10 text-center animate-slide bg-slate-900">
                <div class="text-8xl mb-6 animate-bounce">${won ? 'üïäÔ∏è' : 'üí•'}</div>
                <h2 class="text-4xl font-bold ${color} mb-6 tracking-tight">${won ? t.win : t.lose}</h2>
                <p class="text-slate-300 text-xl mb-10 max-w-2xl leading-relaxed">${won ? t.winMsg : t.loseMsg}</p>
                
                <div class="bg-slate-800 p-6 rounded-2xl w-64 mb-10 border border-slate-700 shadow-xl">
                    <div class="text-sm text-slate-500 mb-2 uppercase tracking-widest">Score</div>
                    <div class="text-5xl font-bold font-mono text-white">${state.score}/100</div>
                </div>

                <button onclick="setLang('${state.lang}')" class="px-10 py-4 bg-blue-600 hover:bg-blue-500 rounded-xl font-bold text-lg transition-colors shadow-lg hover:shadow-blue-500/50">
                    ${t.restart} ‚Üª
                </button>
            </div>
        `;
    }

    function setLang(code) { state.lang = code; state.phase = 'category'; render(); }
    function setCategory(cat) { state.category = cat; state.phase = 'scenario'; render(); }
    function startGame(key) { 
        state.scenarioKey = key; 
        state.phase = 'game'; 
        state.turn = 1; 
        state.score = 50; 
        state.history = []; 
        render(); 
    }
    
    function handleTurn(ans, scoreDelta, question) {
        state.history.push({ sender: 'bot', text: question });
        state.history.push({ sender: 'user', text: ans });
        
        state.score += scoreDelta;
        if(state.score > 100) state.score = 100;
        if(state.score < 0) state.score = 0;
        
        if(state.turn >= state.maxTurns || state.score <= 0) {
            state.phase = 'result';
        } else {
            state.turn++;
        }
        render();
    }

    render();
</script>
</body>
</html>
